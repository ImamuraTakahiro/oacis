%h3 Plot

%script{charset: "utf-8", src: "http://d3js.org/d3.v3.min.js"}

.row
  .span8#plot
    %svg
    #plot-tooltip.progress-tooltip{style: "opacity: 0;"}
  .span4
    %form.form-horizontal
    - parameter_keys = @param_set.simulator.parameter_definitions.map(&:key)
    - plottables = [".energy", ".order_parameter"]
    .control-group
      %label X-Axis:
      .controls
        = select_tag 'x_axis_key', options_for_select(parameter_keys, selected: parameter_keys[0]), id: 'x_axis_key';
    .control-group
      %label Y-Axis:
      .controls
        = select_tag 'y_axis_key', options_for_select(plottables, selected: plottables[0]), id: 'y_axis_key'


:css
  .line {
    fill: none;
    stroke: steelblue;
    stroke-width: 1.5px;
  }
  .axis path,
  .axis line {
    fill: none;
    stroke: #000;
    shape-rendering: crispEdges;
  }

:javascript
  var url = "#{_plot_parameter_set_path(@param_set)}" + ".json";
  function update_plot() {
    var x = $('#x_axis_key').val();
    var y = $('#y_axis_key').val();
    var url_with_param = url + "?x_axis_key=" + encodeURIComponent(x) + "&y_axis_key=" + encodeURIComponent(y);
    draw_plot(url_with_param);
  }
  $('#x_axis_key').on('change', function() {
    update_plot();
  })
  $('#y_axis_key').on('change', function() {
    update_plot();
  })
